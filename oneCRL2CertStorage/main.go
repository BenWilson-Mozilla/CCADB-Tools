package main

import (
	"crypto/x509"
	"encoding/asn1"
	"encoding/base64"
	"encoding/pem"
	"fmt"
)

const mozorg = `-----BEGIN CERTIFICATE-----
MIIFlzCCBH+gAwIBAgIQDjr7lDTxEblG+13uaFQgnTANBgkqhkiG9w0BAQsFADBG
MQswCQYDVQQGEwJVUzEPMA0GA1UEChMGQW1hem9uMRUwEwYDVQQLEwxTZXJ2ZXIg
Q0EgMUIxDzANBgNVBAMTBkFtYXpvbjAeFw0xOTA0MDIwMDAwMDBaFw0yMDA1MDIx
MjAwMDBaMBoxGDAWBgNVBAMTD3d3dy5yZXV0ZXJzLmNvbTCCASIwDQYJKoZIhvcN
AQEBBQADggEPADCCAQoCggEBALnBHAleNa7qPbZ6VurFBcOrCufVNzp3HBU01yjy
HFW0QlgDZKALG63DMO63xUdM6eLjrHkYPpLEMuymjZXqUFVaBJhJVEZXuskr7Brg
cS8Oc8QTuJIIheKrXUBbv2E5+h/RhaHcP9kdi7TVYxZhWhLv8KVIhgbe1b0EDMJJ
PBC9a/+byiHkp0NYRucVne1jSxD2kGzoq6GfTTbGczG04s+5Oi11sEcHGyK/Z4Vg
nlfsvNQVWzYtAFzviFmOh5qTmVlSMf7ax3HjvdD+NudI/vfm8CfkGQv1yrXtZsWz
8PpE6vUxGHBuvza10kUUEatZSndST3yxbGquXr6YIArNbS0CAwEAAaOCAqswggKn
MB8GA1UdIwQYMBaAFFmkZgZSoHuVkjyjlAcnlnRb+T3QMB0GA1UdDgQWBBRG1tJT
fzu0Ch27f6ThPNIt5HdyfjBKBgNVHREEQzBBgg93d3cucmV1dGVycy5jb22CFHd3
dy5yZXV0ZXJzbWVkaWEubmV0ghhpbnRlcm5hbC53d3cucmV1dGVycy5jb20wDgYD
VR0PAQH/BAQDAgWgMB0GA1UdJQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjA7BgNV
HR8ENDAyMDCgLqAshipodHRwOi8vY3JsLnNjYTFiLmFtYXpvbnRydXN0LmNvbS9z
Y2ExYi5jcmwwIAYDVR0gBBkwFzALBglghkgBhv1sAQIwCAYGZ4EMAQIBMHUGCCsG
AQUFBwEBBGkwZzAtBggrBgEFBQcwAYYhaHR0cDovL29jc3Auc2NhMWIuYW1hem9u
dHJ1c3QuY29tMDYGCCsGAQUFBzAChipodHRwOi8vY3J0LnNjYTFiLmFtYXpvbnRy
dXN0LmNvbS9zY2ExYi5jcnQwDAYDVR0TAQH/BAIwADCCAQQGCisGAQQB1nkCBAIE
gfUEgfIA8AB2AKS5CZC0GFgUh7sTosxncAo8NZgE+RvfuON3zQ7IDdwQAAABad0F
uPwAAAQDAEcwRQIgDBRJ68qc16b//LRH5OdUhDOvlai2aUOzuVwSMqx+2mcCIQDG
i/fH3uDdMnsjHreYal9hc2e/wsBIKcPUKz5xp+eqUwB2AId1v+dZfPiMQ5lfvfNu
/1aNR1Y2/0q1YMG06v9eoIMPAAABad0FuhYAAAQDAEcwRQIgD1Ka0EVh6ma5bsLK
iyjmh+fD0Rlxu9FjB9g6A+ZiM+sCIQD3dB/ocz5I3VqK1nhs358AoNxj7eIhzHAH
Tk8nCq3NyjANBgkqhkiG9w0BAQsFAAOCAQEAJzBAKP0KS8T53vtg23UeYFUK8Ljk
FpsztkAYc4pWJ7SA3wa9vQMgHNqsbjgAZzEOcUSqIaA9b43GWRT0p78pgTTydvqn
m4TXhPHD93GE5YuKfb0+Nl7Gq4RAeFKBxWFEOXAFny7/qP77xDEmpmpjUC5ystF6
YVmEGnOT9lB16WXxX0cBoDiD8PyGCZXFMfOTsTMSoY10QrWphdna68N/vymv61Ic
gGjN5Yi8bhW3K7MaQugxW1TJpUJHGeAc8y3PKEnWKu9YihF32KzecyxScoVTpGUQ
rieKaN2tZshMyUj+QZfoAmf2D3AR61dYuJ+Wao5KeEQbd2C5Ol7/updmXg==
-----END CERTIFICATE-----
`

func main() {
	b, _ := pem.Decode([]byte(mozorg))
	c, err := x509.ParseCertificate(b.Bytes)
	if err != nil {
		panic(err)
	}
	i, err := asn1.Marshal(c.Issuer.ToRDNSequence())
	if err != nil {
		panic(err)
	}
	fmt.Println(base64.StdEncoding.EncodeToString(i))
	fmt.Println(base64.StdEncoding.EncodeToString(c.SerialNumber.Bytes()))
}
